<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Netflix Clone</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React Libraries -->
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <!-- Babel to compile JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Firebase Libraries (Compat version for browser scripts) -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>

</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- Firebase Configuration ---
        const firebaseConfig = typeof __firebase_config !== 'undefined' 
            ? JSON.parse(__firebase_config) 
            : { 
                apiKey: "YOUR_API_KEY", 
                authDomain: "YOUR_AUTH_DOMAIN", 
                projectId: "YOUR_PROJECT_ID"
              };

        // --- Initialize Firebase ---
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // --- Main App Component ---
        function App() {
            const [user, setUser] = React.useState(null);
            const [loading, setLoading] = React.useState(true);

            React.useEffect(() => {
                const unsubscribe = auth.onAuthStateChanged((currentUser) => {
                    setUser(currentUser);
                    setLoading(false);
                });
                
                // Sign in anonymously if no other user is present
                if (!auth.currentUser) {
                     auth.signInAnonymously().catch(error => {
                        console.error("Anonymous sign-in failed:", error);
                     });
                }

                return () => unsubscribe();
            }, []);

            if (loading) {
                return <div className="bg-black w-screen h-screen flex justify-center items-center text-white">Loading...</div>;
            }

            return (
                <div className="App">
                    {user && !user.isAnonymous ? <HomeScreen /> : <LoginScreen />}
                </div>
            );
        }

        // --- Login Screen Component ---
        const LoginScreen = () => {
            const [isSignIn, setIsSignIn] = React.useState(true);
            const [email, setEmail] = React.useState('');
            const [password, setPassword] = React.useState('');
            const [error, setError] = React.useState('');

            const handleAuthAction = async (e) => {
                e.preventDefault();
                setError('');
                try {
                    if (isSignIn) {
                        await auth.signInWithEmailAndPassword(email, password);
                    } else {
                        const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                        // Create a user document in Firestore
                        await db.collection("users").doc(userCredential.user.uid).set({
                            email: userCredential.user.email,
                            favorites: []
                        });
                    }
                } catch (err) {
                    setError(err.message);
                }
            };

            const handleGoogleSignIn = async () => {
                const provider = new firebase.auth.GoogleAuthProvider();
                try {
                    const result = await auth.signInWithPopup(provider);
                    const user = result.user;
                    // Create or merge user doc in Firestore
                    await db.collection("users").doc(user.uid).set({
                        email: user.email,
                        favorites: []
                    }, { merge: true });
                } catch (err) {
                    setError(err.message);
                }
            };

            return (
                <div className="relative h-screen w-screen">
                    <img 
                        src="https://assets.nflxext.com/ffe/siteui/vlv3/51e53f54-0d9f-40ec-9e05-c030def06ac9/66a88384-c2ba-4d96-a5a6-7aa0b6a757a6/IN-en-20240513-popsignuptwoweeks-perspective_alpha_website_large.jpg" 
                        alt="background" 
                        className="absolute inset-0 w-full h-full object-cover"
                    />
                    <div className="absolute inset-0 bg-black bg-opacity-50"></div>
                    <header className="absolute top-0 left-0 p-4 md:p-8">
                         <img className="h-8" src="https://upload.wikimedia.org/wikipedia/commons/0/08/Netflix_2015_logo.svg" alt="Netflix Logo" />
                    </header>
                    <div className="relative z-10 flex justify-center items-center h-full">
                        <div className="bg-black bg-opacity-75 p-8 md:p-16 rounded-lg w-full max-w-md">
                            <h1 className="text-3xl font-bold mb-6 text-white">{isSignIn ? 'Sign In' : 'Sign Up'}</h1>
                            {error && <p className="bg-red-500 text-white p-3 rounded mb-4">{error}</p>}
                            <form onSubmit={handleAuthAction}>
                                <input
                                    type="email"
                                    placeholder="Email"
                                    value={email}
                                    onChange={(e) => setEmail(e.target.value)}
                                    className="w-full p-4 mb-4 bg-gray-700 rounded border-none text-white"
                                />
                                <input
                                    type="password"
                                    placeholder="Password"
                                    value={password}
                                    onChange={(e) => setPassword(e.target.value)}
                                    className="w-full p-4 mb-4 bg-gray-700 rounded border-none text-white"
                                />
                                <button type="submit" className="w-full p-4 bg-red-600 rounded font-bold text-white hover:bg-red-700">
                                    {isSignIn ? 'Sign In' : 'Sign Up'}
                                </button>
                            </form>
                            <div className="text-center my-4">
                                <p className="text-gray-500">OR</p>
                            </div>
                             <button onClick={handleGoogleSignIn} className="w-full p-4 bg-white text-black rounded font-bold hover:bg-gray-200 flex items-center justify-center">
                                <svg className="w-6 h-6 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="24px" height="24px"><path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"></path><path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"></path><path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.222,0-9.612-3.311-11.383-7.935l-6.522,5.025C9.505,39.556,16.227,44,24,44z"></path><path fill="#1976D2" d="M43.611,20.083H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571l6.19,5.238C42.012,35.195,44,30.023,44,24C44,22.659,43.862,21.35,43.611,20.083z"></path></svg>
                                Sign In with Google
                            </button>
                            <div className="mt-8 text-gray-500">
                                {isSignIn ? 'New to Netflix?' : 'Already have an account?'}
                                <button onClick={() => setIsSignIn(!isSignIn)} className="text-white font-bold ml-2 hover:underline">
                                    {isSignIn ? 'Sign up now.' : 'Sign in now.'}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // --- Home Screen (Placeholder) ---
        const HomeScreen = () => {
            return (
                <div className="bg-black text-white min-h-screen">
                     <header className="fixed top-0 left-0 right-0 z-50 bg-black bg-opacity-50">
                        <div className="container mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-16">
                            <div className="flex items-center space-x-8">
                                <img className="h-8" src="https://upload.wikimedia.org/wikipedia/commons/0/08/Netflix_2015_logo.svg" alt="Netflix Logo" />
                            </div>
                            <button 
                                onClick={() => auth.signOut()} 
                                className="bg-red-600 px-4 py-2 rounded font-bold text-white hover:bg-red-700"
                            >
                                Sign Out
                            </button>
                        </div>
                    </header>
                    <main className="pt-24">
                        <h1 className="text-4xl text-center">Welcome to Netflix!</h1>
                        <p className="text-center mt-4">Content will be loaded here soon.</p>
                    </main>
                </div>
            );
        };

        // --- Render the App ---
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
